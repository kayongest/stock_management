<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>:: LOGIN</title>
    <link rel="icon" type="image/x-icon" href="../assets/img/enter.png" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <link href="../assets/css/vendor.min.css" rel="stylesheet" />
    <link href="../assets/css/default/app.min.css" rel="stylesheet" />

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Toastr CSS -->
    <!-- <link
      href="https://cdn.jsdelivr.net/npm/toastr@latest/toastr.min.css"
      rel="stylesheet"
    /> -->

    <!-- SweetAlert2 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
      rel="stylesheet"
    />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Titillium+Web:wght@200;300;400;600;700&display=swap");
      * {
        font-family: "Titillium Web", sans-serif;
      }
      .app-header {
        background-color: #20425f;
      }

      .toast-top-center {
        top: 40px; /* Adjust as needed */
        z-index: 9999; /* Ensure it's above other elements */
      }

      .login-page {
        width: 360px;
        padding: 8% 0 0;
        margin: auto;
      }
      .form {
        position: relative;
        z-index: 1;
        background: #ffffff;
        max-width: 360px;
        margin: 0 auto 100px;
        padding: 45px;
        text-align: center;
        box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2),
          0 5px 5px 0 rgba(0, 0, 0, 0.24);
      }
      .form input {
        font-family: "Roboto", sans-serif;
        outline: 0;
        background: #f2f2f2;
        width: 100%;
        border: 0;
        margin: 0 0 15px;
        padding: 15px;
        box-sizing: border-box;
        font-size: 14px;
      }
      .form button {
        font-family: "Roboto", sans-serif;
        text-transform: uppercase;
        outline: 0;
        background: #203241;
        width: 100%;
        border-radius: 5px;
        padding: 15px;
        color: #ffffff;
        font-size: 14px;
        -webkit-transition: all 0.3 ease;
        transition: all 0.3 ease;
        cursor: pointer;
      }
      .form button:hover,
      .form button:active,
      .form button:focus {
        background: #07668f;
      }
      .form .message {
        margin: 15px 0 0;
        color: #b3b3b3;
        font-size: 12px;
      }
      .form .message a {
        color: #074058;
        text-decoration: none;
      }
      .form .register-form {
        display: none;
      }
      .container {
        position: relative;
        z-index: 1;
        max-width: 300px;
        margin: 0 auto;
      }
      .container:before,
      .container:after {
        content: "";
        display: block;
        clear: both;
      }
      .container .info {
        margin: 50px auto;
        text-align: center;
      }
      .container .info h1 {
        margin: 0 0 15px;
        padding: 0;
        font-size: 36px;
        font-weight: 300;
        color: #1a1a1a;
      }
      .container .info span {
        color: #4d4d4d;
        font-size: 12px;
      }
      .container .info span a {
        color: #000000;
        text-decoration: none;
      }
      .container .info span .fa {
        color: #ef3b3a;
      }
      body {
        background: #07668f; /* fallback for old browsers */
        background: rgb(141, 194, 111);
        background: linear-gradient(
          90deg,
          rgba(141, 194, 111, 1) 0%,
          rgba(118, 184, 82, 1) 50%
        );
        font-family: "Roboto", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .form {
        background-color: transparent;
        /* Optionally add some styling for the form elements */
        padding: 20px;
        border-radius: 8px;
      }

      .register-form,
      .login-form {
        background-color: transparent; /* Makes form background transparent */
        padding: 25px;
        /* Optional: you can keep the border for visibility */
        /* border: 1px solid #ccc;  */
        border-radius: 8px;
         /* Optional: for some subtle shadow */
        /* box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); */
      }

      input,
      button {
        margin-bottom: 10px;
        padding: 10px;
        width: 100%;
        border-radius: 5px;
        border: 1px solid #ddd;
      }

      button {
        background-color: #4caf50; /* Green background for the button */
        color: white;
      }

      button:hover {
        background-color: #45a049; /* Hover effect */
      }
    </style>
  </head>
  <body class="pace-top">
    <div id="loader" class="app-loader">
      <span class="spinner"></span>
    </div>
    <div id="app" class="app">
      <div class="login login-v2 fw-bold">
        <div class="login-cover">
          <div
            class="login-cover-img"
            style="
              background-image: url(../assets/img/gallery/gallery-26-thumb.jpg);
            "
            data-id="login-cover-image"
          ></div>
          <div class="login-cover-bg"></div>
        </div>
        <div class="login-container">
          <div class="login-header">
            <div class="brand">
              <div class="d-flex align-items-center"><b>LOGIN</b></div>
            </div>
            <div class="icon">
              <img
                src="../assets/img/enter.png"
                width="50px"
                height="50px"
                alt=""
              />
            </div>
          </div>
          <!-- <div class="login-content">
            <form id="loginForm" method="POST">
              <div class="form-floating mb-20px">
                <input
                  type="text"
                  class="form-control fs-13px h-45px border-0"
                  placeholder="Email Address"
                  id="emailAddress"
                  name="email"
                  required
                />
                <label
                  for="emailAddress"
                  class="d-flex align-items-center text-gray-600 fs-13px"
                  >Email Address</label
                >
              </div>
              <div class="form-floating mb-20px">
                <input
                  type="password"
                  class="form-control fs-13px h-45px border-0"
                  placeholder="Password"
                  id="password"
                  name="password"
                  required
                />
                <label
                  for="password"
                  class="d-flex align-items-center text-gray-600 fs-13px"
                  >Password</label
                >
              </div>
              <div class="mb-20px">
                <button
                  type="submit"
                  class="btn btn-theme d-block w-100 h-45px btn-lg"
                >
                  Login
                </button>
              </div>
              <hr>
              
              <div class="mb-20px">
                <button
                  type="submit"
                  class="btn btn-theme d-block w-20 h-45px btn-md"
                >
                  Register
                </button>
              </div>
            </form>
          </div> -->
          <div class="login-page">
            <div class="form">
              <!-- Register Form -->
              <form id="registerForm" class="register-form">
                <input type="text" id="registerName" placeholder="Name" />
                <input type="text" id="registerPhone" placeholder="Phone" />
                <input
                  type="email"
                  id="registerEmail"
                  placeholder="Email Address"
                />
                <input
                  type="password"
                  id="registerPassword"
                  placeholder="Password"
                />
                <button type="submit">Register</button>
                <p class="message">
                  Already registered? <a href="#" class="toggle-form">Log In</a>
                </p>
              </form>

              <!-- Login Form -->
              <form id="loginForm" class="login-form">
                <input type="email" id="loginEmail" placeholder="Email" />
                <input
                  type="password"
                  id="loginPassword"
                  placeholder="Password"
                />
                <button type="submit">Login</button>
                <p class="message">
                  Not registered?
                  <a href="#" class="toggle-form">Register user</a>
                </p>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toastr JS -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/toastr@latest/toastr.min.js"></script> -->

    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
      $(document).ready(function () {
        // Handle the login form submission
        $("#loginForm").submit(function (event) {
          event.preventDefault(); // Prevent default form submission

          var formData = {
            email: $("#loginEmail").val(),
            password: $("#loginPassword").val(),
          };

          console.log(formData); // Log the form data to ensure it has values

          $.ajax({
            url: "login.php",
            type: "POST",
            data: formData,
            dataType: "json",
            success: function (response) {
              console.log(response); // Log the server response

              // Check the status of the response
              if (response.status === "success") {
                // Show SweetAlert2 success pop-up
                Swal.fire({
                  icon: "success",
                  html: `Welcome <strong>${response.full_name}!</strong>`,
                  timer: 3000,
                  showConfirmButton: false,
                  timerProgressBar: true,
                  didOpen: () => {
                    Swal.showLoading(); // Show progress bar during the countdown
                  },
                });

                // Redirect after the timer ends
                setTimeout(function () {
                  window.location.href = response.redirect_url; // Redirect based on the role
                }, 3000);
              } else {
                // Show SweetAlert2 error pop-up
                Swal.fire({
                  icon: "error",
                  title: "Error",
                  text: response.message,
                });
              }
            },
          });
        });

        // Handle the registration form submission
        $("#registerForm").submit(function (event) {
          event.preventDefault(); // Prevent default form submission

          var formData = {
            full_name: $("#registerName").val(),
            phone: $("#registerPhone").val(),
            email: $("#registerEmail").val(),
            password: $("#registerPassword").val(),
          };

          console.log(formData); // Log the form data to ensure it has values

          $.ajax({
            url: "register_user.php",
            type: "POST",
            data: formData,
            dataType: "json",
            success: function (response) {
              console.log(response); // Log the server response

              // Show SweetAlert2 success pop-up
              if (response.status === "success") {
                Swal.fire({
                  icon: "success",
                  // title: "Registration Successful!",
                  text: response.message,
                  confirmButtonText: "Log In Now",
                }).then(() => {
                  $(".register-form").hide();
                  $(".login-form").show();
                });
              } else {
                Swal.fire({
                  icon: "error",
                  title: "Error",
                  text: response.message,
                });
              }
            },
          });
        });

        // Toggle between Login and Register forms
        $(".toggle-form").click(function (event) {
          event.preventDefault();

          // Check if the user clicked 'Log In' or 'Register user'
          if ($(this).text().trim() === "Log In") {
            $(".login-form").show();
            $(".register-form").hide();
          } else {
            $(".register-form").show();
            $(".login-form").hide();
          }
        });
      });
    </script>

    <script src="../assets/js/vendor.min.js"></script>
    <script src="../assets/js/app.min.js"></script>
  </body>
</html>
